package excelExample;

import java.sql.*;
import java.io.*;

public class SimpleCsv2DbInserter {
	
	public static void main(String args[]) {
		
		String jdbcURL = "jdbc:mysql://localhost:3306/testdb";
		String username = "root";
		String password = "root";
		
		String csvFilePath = "Reviews-simple.csv";
		int batchSize = 20;
		
		Connection connection = null;
		
		try {
			
			connection = DriverManager.getConnection(jdbcURL, username, password);
			connection.setAutoCommit(false);
			
			String sql = "INSERT INTO review(course_name, student_name, timestamp, rating, comment) VALUES (?, ?, ?, ?, ?)";
			PreparedStatement statement = connection.prepareStatement(sql);
			
			BufferedReader lineReader = new BufferedReader(new FileReader(csvFilePath));
			String lineText = null;
			
			int count = 0;
			
			lineReader.readLine();
			
			 while ((lineText = lineReader.readLine()) != null) {
				
				String[] data = lineText.split(",");
				String courseName = data[0];
				String studentName = data[1];
				String timeStamp = data[2];
				String rating = data[3];
				String comment = data.length == 5 ? data[4] : "";
				
				
				
			}
			
		} catch(IOException ex) {
			
			System.err.println(ex);
			
		} catch(SQLException ex) {
			
			System.err.println(ex);
			
			try {
				connection.rollback();
			}catch(SQLException e) {
				System.err.println(e);
			}
			
		}
		
	}
	
}
